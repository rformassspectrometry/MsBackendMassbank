<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>MS backend accessing the MassBank MySQL database — MsBackendMassbankSql • MsBackendMassbank</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="MS backend accessing the MassBank MySQL database — MsBackendMassbankSql" />
<meta property="og:description" content="The MsBackendMassbankSql provides access to mass spectrometry data from
MassBank by directly accessing its
MySQL/MariaDb database. In addition it supports adding new spectra variables
or locally changing spectra variables provided by MassBank (withoug
changing the original values in the database).
Note that MsBackendMassbankSql requires a local installation of the
MassBank database since direct database access is not supported for the
main MassBank instance.
Also, some of the fields in the MassBank database are not directly compatible
with Spectra, such as the collision energy which is not available as a
numeric value. The collision energy as available in MassBank is reported as
spectra variable &quot;collision_energy_text&quot;. Also, precursor m/z values
reported for some spectra can not be converted to a numeric and hence NA
is reported with the spectra variable precursorMz for these spectra. The
variable &quot;precursor_mz_text&quot; can be used to get the original precursor
m/z reported in MassBank." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MsBackendMassbank</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/MsBackendMassbank.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/michaelwitting/MsBackendMassbank/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>MS backend accessing the MassBank MySQL database</h1>
    <small class="dont-index">Source: <a href='https://github.com/michaelwitting/MsBackendMassbank/blob/master/R/MsBackendMassbankSql-functions.R'><code>R/MsBackendMassbankSql-functions.R</code></a>, <a href='https://github.com/michaelwitting/MsBackendMassbank/blob/master/R/MsBackendMassbankSql.R'><code>R/MsBackendMassbankSql.R</code></a></small>
    <div class="hidden name"><code>MsBackendMassbankSql.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>MsBackendMassbankSql</code> provides access to mass spectrometry data from
<a href='https://massbank.eu/MassBank/'>MassBank</a> by directly accessing its
MySQL/MariaDb database. In addition it supports adding new spectra variables
or <em>locally</em> changing spectra variables provided by MassBank (withoug
changing the original values in the database).</p>
<p>Note that <code>MsBackendMassbankSql</code> requires a local installation of the
MassBank database since direct database access is not supported for the
<em>main</em> MassBank instance.</p>
<p>Also, some of the fields in the MassBank database are not directly compatible
with <code>Spectra</code>, such as the <em>collision energy</em> which is not available as a
numeric value. The collision energy as available in MassBank is reported as
spectra variable <code>"collision_energy_text"</code>. Also, precursor m/z values
reported for some spectra can not be converted to a <code>numeric</code> and hence <code>NA</code>
is reported with the spectra variable <code>precursorMz</code> for these spectra. The
variable <code>"precursor_mz_text"</code> can be used to get the <em>original</em> precursor
m/z reported in MassBank.</p>
    </div>

    <pre class="usage">MsBackendMassbankSql()

# S4 method for MsBackendMassbankSql
show(object)

# S4 method for MsBackendMassbankSql
backendInitialize(object, dbcon, ...)

# S4 method for MsBackendMassbankSql
acquisitionNum(object)

# S4 method for MsBackendMassbankSql
peaksData(object)

# S4 method for MsBackendMassbankSql
centroided(object)

# S4 method for MsBackendMassbankSql
centroided(object) &lt;- value

# S4 method for MsBackendMassbankSql
collisionEnergy(object)

# S4 method for MsBackendMassbankSql
collisionEnergy(object) &lt;- value

# S4 method for MsBackendMassbankSql
dataOrigin(object)

# S4 method for MsBackendMassbankSql
dataOrigin(object) &lt;- value

# S4 method for MsBackendMassbankSql
dataStorage(object)

# S4 method for MsBackendMassbankSql
intensity(object)

# S4 method for MsBackendMassbankSql
intensity(object) &lt;- value

# S4 method for MsBackendMassbankSql
ionCount(object)

# S4 method for MsBackendMassbankSql
isEmpty(x)

# S4 method for MsBackendMassbankSql
isolationWindowLowerMz(object)

# S4 method for MsBackendMassbankSql
isolationWindowLowerMz(object) &lt;- value

# S4 method for MsBackendMassbankSql
isolationWindowTargetMz(object)

# S4 method for MsBackendMassbankSql
isolationWindowTargetMz(object) &lt;- value

# S4 method for MsBackendMassbankSql
isolationWindowUpperMz(object)

# S4 method for MsBackendMassbankSql
isolationWindowUpperMz(object) &lt;- value

# S4 method for MsBackendMassbankSql
length(x)

# S4 method for MsBackendMassbankSql
msLevel(object)

# S4 method for MsBackendMassbankSql
mz(object)

# S4 method for MsBackendMassbankSql
mz(object) &lt;- value

# S4 method for MsBackendMassbankSql
lengths(x, use.names = FALSE)

# S4 method for MsBackendMassbankSql
polarity(object)

# S4 method for MsBackendMassbankSql
polarity(object) &lt;- value

# S4 method for MsBackendMassbankSql
precursorCharge(object)

# S4 method for MsBackendMassbankSql
precursorIntensity(object)

# S4 method for MsBackendMassbankSql
precursorMz(object)

# S4 method for MsBackendMassbankSql
reset(object)

# S4 method for MsBackendMassbankSql
rtime(object)

# S4 method for MsBackendMassbankSql
rtime(object) &lt;- value

# S4 method for MsBackendMassbankSql
scanIndex(object)

# S4 method for MsBackendMassbankSql
selectSpectraVariables(object, spectraVariables = spectraVariables(object))

# S4 method for MsBackendMassbankSql
smoothed(object)

# S4 method for MsBackendMassbankSql
smoothed(object) &lt;- value

# S4 method for MsBackendMassbankSql
spectraData(object, columns = spectraVariables(object))

# S4 method for MsBackendMassbankSql
spectraData(object) &lt;- value

# S4 method for MsBackendMassbankSql
spectraNames(object)

# S4 method for MsBackendMassbankSql
spectraNames(object) &lt;- value

# S4 method for MsBackendMassbankSql
spectraVariables(object)

# S4 method for MsBackendMassbankSql
tic(object, initial = TRUE)

# S4 method for MsBackendMassbankSql
[(x, i, j, ..., drop = FALSE)

# S4 method for MsBackendMassbankSql
$(x, name)

# S4 method for MsBackendMassbankSql
$(x, name) &lt;- value

# S4 method for Spectra
compounds(object, ...)

# S4 method for MsBackendMassbankSql
compounds(object, ...)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>Object extending <code>MsBackendMassbankSql</code>.</p></td>
    </tr>
    <tr>
      <th>dbcon</th>
      <td><p>For <code>backendInitialize,MsBackendMassbankSql</code>: SQL database
connection to the MassBank (MariaDb) database.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments.</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>replacement value for <code>&lt;-</code> methods. See individual
method description or expected data type.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>Object extending <code>MsBackendMassbankSql</code>.</p></td>
    </tr>
    <tr>
      <th>use.names</th>
      <td><p>For <code>lengths</code>: whether spectrum names should be used.</p></td>
    </tr>
    <tr>
      <th>spectraVariables</th>
      <td><p>For <code>selectSpectraVariables</code>: <code>character</code> with the
names of the spectra variables to which the backend should be subsetted.</p></td>
    </tr>
    <tr>
      <th>columns</th>
      <td><p>For <code>spectraData</code> accessor: optional <code>character</code> with column
names (spectra variables) that should be included in the
returned <code>DataFrame</code>. By default, all columns are returned.</p></td>
    </tr>
    <tr>
      <th>initial</th>
      <td><p>For <code>tic</code>: <code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code> whether the initially
reported total ion current should be reported, or whether the
total ion current should be (re)calculated on the actual data
(<code>initial = FALSE</code>).</p></td>
    </tr>
    <tr>
      <th>i</th>
      <td><p>For <code><a href='https://rdrr.io/r/base/Extract.html'>[</a></code>: <code>integer</code>, <code>logical</code> or <code>character</code> to subset the object.</p></td>
    </tr>
    <tr>
      <th>j</th>
      <td><p>For <code><a href='https://rdrr.io/r/base/Extract.html'>[</a></code>: not supported.</p></td>
    </tr>
    <tr>
      <th>drop</th>
      <td><p>For <code><a href='https://rdrr.io/r/base/Extract.html'>[</a></code>: not considered.</p></td>
    </tr>
    <tr>
      <th>name</th>
      <td><p>For <code><a href='https://rdrr.io/r/base/Extract.html'>$</a></code> and <code>$&lt;-</code>: the name of the spectra variable to return
or set.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>See documentation of respective function.</p>
    <h2 class="hasAnchor" id="supported-backend-functions"><a class="anchor" href="#supported-backend-functions"></a>Supported Backend functions</h2>

    


<p>The following functions are supported by the <code>MsBackendMassbankSqlMassbankDb</code>.</p><ul>
<li><p><code><a href='https://rdrr.io/r/base/Extract.html'>[</a></code>: subset the backend. Only subsetting by element (<em>row</em>/<code>i</code>) is
allowed</p></li>
<li><p><code><a href='https://rdrr.io/r/base/Extract.html'>$</a></code>, <code>$&lt;-</code>: access or set/add a single spectrum variable (column) in the
backend.</p></li>
<li><p><code>acquisitionNum</code>: returns the acquisition number of each
spectrum. Returns an <code>integer</code> of length equal to the number of
spectra (with <code>NA_integer_</code> if not available).</p></li>
<li><p><code>peaksData</code> returns a <code>list</code> with the spectras' peak data. The length of
the list is equal to the number of spectra in <code>object</code>. Each element of
the list is a <code>matrix</code> with columns <code>"mz"</code> and <code>"intensity"</code>. For an empty
spectrum, a <code>matrix</code> with 0 rows and two columns (named <code>mz</code> and
<code>intensity</code>) is returned.</p></li>
<li><p><code>backendInitialize</code>: initialises the backend by retrieving the IDs of all
spectra in the database. Parameter <code>dbcon</code> with the connection to the
MassBank MySQL database is required.</p></li>
<li><p><code>dataOrigin</code>: gets a <code>character</code> of length equal to the number of spectra
in <code>object</code> with the <em>data origin</em> of each spectrum. This could e.g. be
the mzML file from which the data was read.</p></li>
<li><p><code>dataStorage</code>: returns <code>"&lt;MassBank&gt;"</code> for all spectra.</p></li>
<li><p><code>centroided</code>, <code>centroided&lt;-</code>: gets or sets the centroiding
information of the spectra. <code>centroided</code> returns a <code>logical</code>
vector of length equal to the number of spectra with <code>TRUE</code> if a
spectrum is centroided, <code>FALSE</code> if it is in profile mode and <code>NA</code>
if it is undefined. See also <code>isCentroided</code> for estimating from
the spectrum data whether the spectrum is centroided.  <code>value</code>
for <code>centroided&lt;-</code> is either a single <code>logical</code> or a <code>logical</code> of
length equal to the number of spectra in <code>object</code>.</p></li>
<li><p><code>collisionEnergy</code>, <code>collisionEnergy&lt;-</code>: gets or sets the
collision energy for all spectra in <code>object</code>. <code>collisionEnergy</code>
returns a <code>numeric</code> with length equal to the number of spectra
(<code>NA_real_</code> if not present/defined), <code>collisionEnergy&lt;-</code> takes a
<code>numeric</code> of length equal to the number of spectra in <code>object</code>. Note that
the collision energy description from MassBank are provided as spectra
variable <code>"collisionEnergyText"</code>.</p></li>
<li><p><code>intensity</code>: gets the intensity values from the spectra. Returns
a <code>NumericList()</code> of <code>numeric</code> vectors (intensity values for each
spectrum). The length of the <code>list</code> is equal to the number of
<code>spectra</code> in <code>object</code>.</p></li>
<li><p><code>ionCount</code>: returns a <code>numeric</code> with the sum of intensities for
each spectrum. If the spectrum is empty (see <code>isEmpty</code>),
<code>NA_real_</code> is returned.</p></li>
<li><p><code>isCentroided</code>: a heuristic approach assessing if the spectra in
<code>object</code> are in profile or centroided mode. The function takes
the <code>qtl</code> th quantile top peaks, then calculates the difference
between adjacent m/z value and returns <code>TRUE</code> if the first
quartile is greater than <code>k</code>. (See <code>Spectra:::.isCentroided</code> for
the code.)</p></li>
<li><p><code>isEmpty</code>: checks whether a spectrum in <code>object</code> is empty
(i.e. does not contain any peaks). Returns a <code>logical</code> vector of
length equal number of spectra.</p></li>
<li><p><code>isolationWindowLowerMz</code>, <code>isolationWindowLowerMz&lt;-</code>: gets or sets the
lower m/z boundary of the isolation window.</p></li>
<li><p><code>isolationWindowTargetMz</code>, <code>isolationWindowTargetMz&lt;-</code>: gets or sets the
target m/z of the isolation window.</p></li>
<li><p><code>isolationWindowUpperMz</code>, <code>isolationWindowUpperMz&lt;-</code>: gets or sets the
upper m/z boundary of the isolation window.</p></li>
<li><p><code>isReadOnly</code>: returns a <code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code> whether the backend is <em>read
only</em> or does allow also to write/update data.</p></li>
<li><p><code>length</code>: returns the number of spectra in the object.</p></li>
<li><p><code>lengths</code>: gets the number of peaks (m/z-intensity values) per
spectrum.  Returns an <code>integer</code> vector (length equal to the
number of spectra). For empty spectra, <code>0</code> is returned.</p></li>
<li><p><code>msLevel</code>: gets the spectra's MS level. Returns an <code>integer</code>
vector (of length equal to the number of spectra) with the MS
level for each spectrum (or <code>NA_integer_</code> if not available).</p></li>
<li><p><code>mz</code>: gets the mass-to-charge ratios (m/z) from the
spectra. Returns a <code>NumericList()</code> or length equal to the number of
spectra, each element a <code>numeric</code> vector with the m/z values of
one spectrum.</p></li>
<li><p><code>polarity</code>, <code>polarity&lt;-</code>: gets or sets the polarity for each
spectrum.  <code>polarity</code> returns an <code>integer</code> vector (length equal
to the number of spectra), with <code>0</code> and <code>1</code> representing negative
and positive polarities, respectively. <code>polarity&lt;-</code> expects an
integer vector of length 1 or equal to the number of spectra.</p></li>
<li><p><code>precursorCharge</code>, <code>precursorIntensity</code>, <code>precursorMz</code>,
<code>precScanNum</code>, <code>precAcquisitionNum</code>: get the charge (<code>integer</code>),
intensity (<code>numeric</code>), m/z (<code>numeric</code>), scan index (<code>integer</code>)
and acquisition number (<code>interger</code>) of the precursor for MS level
2 and above spectra from the object. Returns a vector of length equal to
the number of spectra in <code>object</code>. <code>NA</code> are reported for MS1
spectra of if no precursor information is available.</p></li>
<li><p><code>reset</code>: restores the backend to its original state, i.e. deletes all
locally modified data and reinitializes the backend to the full data
available in the database.</p></li>
<li><p><code>rtime</code>, <code>rtime&lt;-</code>: gets or sets the retention times for each
spectrum (in seconds). <code>rtime</code> returns a <code>numeric</code> vector (length equal to
the number of spectra) with the retention time for each spectrum.
<code>rtime&lt;-</code> expects a numeric vector with length equal to the
number of spectra.</p></li>
<li><p><code>scanIndex</code>: returns an <code>integer</code> vector with the <em>scan index</em>
for each spectrum. This represents the relative index of the
spectrum within each file. Note that this can be different to the
<code>acquisitionNum</code> of the spectrum which is the index of the
spectrum as reported in the mzML file.</p></li>
<li><p><code>selectSpectraVariables</code>: reduces the information within the backend to
the selected spectra variables.</p></li>
<li><p><code>smoothed</code>,<code>smoothed&lt;-</code>: gets or sets whether a spectrum is
<em>smoothed</em>. <code>smoothed</code> returns a <code>logical</code> vector of length equal
to the number of spectra. <code>smoothed&lt;-</code> takes a <code>logical</code> vector
of length 1 or equal to the number of spectra in <code>object</code>.</p></li>
<li><p><code>spectraData</code>: gets general spectrummetadata (annotation, also called
header).  <code>spectraData</code> returns a <code>DataFrame</code>. Note that replacing the
spectra data with <code>spectraData&lt;-</code> is not supported.</p></li>
<li><p><code>spectraNames</code>: returns a <code>character</code> vector with the names of
the spectra in <code>object</code>.</p></li>
<li><p><code>spectraVariables</code>: returns a <code>character</code> vector with the
available spectra variables (columns, fields or attributes)
available in <code>object</code>. This should return <strong>all</strong> spectra variables which
are present in <code>object</code>, also <code>"mz"</code> and <code>"intensity"</code> (which are by
default not returned by the <code>spectraVariables,Spectra</code> method).</p></li>
<li><p><code>tic</code>: gets the total ion current/count (sum of signal of a
spectrum) for all spectra in <code>object</code>. By default, the value
reported in the original raw data file is returned. For an empty
spectrum, <code>NA_real_</code> is returned.</p></li>
</ul>

    <h2 class="hasAnchor" id="not-supported-backend-functions"><a class="anchor" href="#not-supported-backend-functions"></a>Not supported Backend functions</h2>

    


<p>The following functions are not supported by the <code>MsBackendMassbankSql</code> since
the original data can not be changed.</p>
<p><code>backendMerge</code>, <code>export</code>, <code>filterDataStorage</code>, <code>filterPrecursorScan</code>,
<code>peaksData&lt;-</code>, <code>filterAcquisitionNum</code>, <code>intensity&lt;-</code>, <code>mz&lt;-</code>, <code>precScanNum</code>,
<code>spectraData&lt;-</code>, <code>spectraNames&lt;-</code>.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Johannes Rainer</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Create a connection to a database with MassBank data - in the present</span>
<span class='co'>## example we connect to a tiny SQLite database bundled in this package</span>
<span class='co'>## as public access to the MassBank MySQL is not (yet) supported. See the</span>
<span class='co'>## vignette for more information on how to install MassBank locally and</span>
<span class='co'>## enable MySQL database connections</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://rsqlite.r-dbi.org'>RSQLite</a></span><span class='op'>)</span>
<span class='va'>con</span> <span class='op'>&lt;-</span> <span class='fu'>dbConnect</span><span class='op'>(</span><span class='fu'><a href='https://rsqlite.r-dbi.org/reference/SQLite.html'>SQLite</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"sql/minimassbank.sql"</span>, package <span class='op'>=</span> <span class='st'>"MsBackendMassbank"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## Given that we have the connection to a MassBank databas we can</span>
<span class='co'>## initialize the backend:</span>
<span class='va'>be</span> <span class='op'>&lt;-</span> <span class='fu'>backendInitialize</span><span class='op'>(</span><span class='fu'>MsBackendMassbankSql</span><span class='op'>(</span><span class='op'>)</span>, dbcon <span class='op'>=</span> <span class='va'>con</span><span class='op'>)</span>
<span class='va'>be</span>
</div><div class='output co'>#&gt; MsBackendMassbankSql with 70 spectra
#&gt;      msLevel precursorMz  polarity
#&gt;    &lt;integer&gt;   &lt;numeric&gt; &lt;integer&gt;
#&gt; 1          2     506.000         0
#&gt; 2         NA          NA         1
#&gt; 3         NA          NA         0
#&gt; 4         NA          NA         1
#&gt; 5         NA          NA         0
#&gt; 6          2     185.028         0
#&gt; 7          2     455.290         1
#&gt; 8          2     253.051         0
#&gt; 9          2     358.238         1
#&gt; 10         2     256.170         1
#&gt;  ... 33 more variables/columns.
#&gt;  Use  'spectraVariables' to list all of them.</div><div class='input'>
<span class='co'>## Access MS level</span>
<span class='fu'>msLevel</span><span class='op'>(</span><span class='va'>be</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1]  2 NA NA NA NA  2 NA NA NA NA NA NA NA NA NA NA NA NA NA NA  2  2  2  2  2
#&gt; [26]  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2
#&gt; [51]  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2</div><div class='input'><span class='va'>be</span><span class='op'>$</span><span class='va'>msLevel</span>
</div><div class='output co'>#&gt;  [1]  2 NA NA NA NA  2 NA NA NA NA NA NA NA NA NA NA NA NA NA NA  2  2  2  2  2
#&gt; [26]  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2
#&gt; [51]  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2</div><div class='input'>
<span class='co'>## Access m/z values</span>
<span class='va'>be</span><span class='op'>$</span><span class='va'>mz</span>
</div><div class='output co'>#&gt; NumericList of length 70
#&gt; [["MCH00020"]] 146.760803 158.863541 174.988785 ... 487.989319 585.88446
#&gt; [["MCH00002"]] 22.99 23.07 23.19 38.98 53.15 ... 413.22 414.22 429.16 495.2
#&gt; [["MCH00006"]] 108.099566 152.005378 153.01824 ... 409.06729 499.103447
#&gt; [["MCH00009"]] 137.0227 138.025605 139.034602 ... 316.303106 352.234228
#&gt; [["MCH00014"]] 112.977759 205.053323 208.041128 ... 671.1778 673.200866
#&gt; [["MCH00019"]] 78.893929 183.011719 193.957916 ... 408.010193 426.021942
#&gt; [["MCH00012"]] 167.03389 168.040758 333.079965 ... 365.040698 373.073473
#&gt; [["MCH00003"]] 195.09167 196.095033
#&gt; [["MCH00016"]] 108.096149 152.004656 153.01824 ... 409.065314 491.043775
#&gt; [["MCH00001"]] 1278.12 1279.11 1279.18 1306.21 ... 2091.32 2092.3 2136.33
#&gt; ...
#&gt; &lt;60 more elements&gt;</div><div class='input'>
<span class='co'>## Access the full spectra data (including m/z and intensity values)</span>
<span class='fu'>spectraData</span><span class='op'>(</span><span class='va'>be</span><span class='op'>)</span>
</div><div class='output co'>#&gt; DataFrame with 70 rows and 36 columns
#&gt;       msLevel     rtime acquisitionNum scanIndex                             mz
#&gt;     &lt;integer&gt; &lt;numeric&gt;      &lt;integer&gt; &lt;integer&gt;                  &lt;NumericList&gt;
#&gt; 1           2        NA             NA        NA    146.761,158.864,174.989,...
#&gt; 2          NA        NA             NA        NA          22.99,23.07,23.19,...
#&gt; 3          NA        NA             NA        NA    108.100,152.005,153.018,...
#&gt; 4          NA        NA             NA        NA    137.023,138.026,139.035,...
#&gt; 5          NA        NA             NA        NA    112.978,205.053,208.041,...
#&gt; ...       ...       ...            ...       ...                            ...
#&gt; 66          2        NA             NA        NA                        185.028
#&gt; 67          2        NA             NA        NA    58.0653,77.0386,79.0543,...
#&gt; 68          2        NA             NA        NA    132.021,133.029,135.009,...
#&gt; 69          2        NA             NA        NA    53.0388,54.0340,55.0544,...
#&gt; 70          2        NA             NA        NA  88.0757,151.0540,152.0620,...
#&gt;                                intensity dataStorage             dataOrigin
#&gt;                            &lt;NumericList&gt; &lt;character&gt;            &lt;character&gt;
#&gt; 1     0.980184,938.145447, 56.718353,...  &lt;MassBank&gt;                     NA
#&gt; 2                     3173,2266, 880,...  &lt;MassBank&gt;                     NA
#&gt; 3                 2809,119550, 91935,...  &lt;MassBank&gt;                     NA
#&gt; 4               157703, 23566,  5190,...  &lt;MassBank&gt;                     NA
#&gt; 5                     5686, 927, 756,...  &lt;MassBank&gt;                     NA
#&gt; ...                                  ...         ...                    ...
#&gt; 66                              34967548  &lt;MassBank&gt; Schymanski, E. L.; R..
#&gt; 67           9143284, 341391,5278218,...  &lt;MassBank&gt; Schymanski, E. L.; R..
#&gt; 68         82825.8,290504.6,301494.3,...  &lt;MassBank&gt; Schymanski, E. L.; R..
#&gt; 69         1568742,19224644, 4676170,...  &lt;MassBank&gt; Schymanski, E. L.; R..
#&gt; 70          678846,  403851,11111366,...  &lt;MassBank&gt; Schymanski, E. L.; R..
#&gt;     centroided  smoothed  polarity precScanNum precursorMz precursorIntensity
#&gt;      &lt;logical&gt; &lt;logical&gt; &lt;integer&gt;   &lt;integer&gt;   &lt;numeric&gt;          &lt;numeric&gt;
#&gt; 1           NA        NA         0          NA         506                408
#&gt; 2           NA        NA         1          NA          NA                 NA
#&gt; 3           NA        NA         0          NA          NA                 NA
#&gt; 4           NA        NA         1          NA          NA                 NA
#&gt; 5           NA        NA         0          NA          NA                 NA
#&gt; ...        ...       ...       ...         ...         ...                ...
#&gt; 66          NA        NA         0          NA     185.028            185.028
#&gt; 67          NA        NA         1          NA     455.290            455.290
#&gt; 68          NA        NA         0          NA     253.051            253.051
#&gt; 69          NA        NA         1          NA     358.238            358.237
#&gt; 70          NA        NA         1          NA     256.170            256.169
#&gt;     precursorCharge collisionEnergy isolationWindowLowerMz
#&gt;           &lt;integer&gt;       &lt;numeric&gt;              &lt;numeric&gt;
#&gt; 1                NA              NA                     NA
#&gt; 2                NA              NA                     NA
#&gt; 3                NA              NA                     NA
#&gt; 4                NA              NA                     NA
#&gt; 5                NA              NA                     NA
#&gt; ...             ...             ...                    ...
#&gt; 66               NA              NA                     NA
#&gt; 67               NA              NA                     NA
#&gt; 68               NA              NA                     NA
#&gt; 69               NA              NA                     NA
#&gt; 70               NA              NA                     NA
#&gt;     isolationWindowTargetMz isolationWindowUpperMz spectrum_id
#&gt;                   &lt;numeric&gt;              &lt;numeric&gt; &lt;character&gt;
#&gt; 1                        NA                     NA    MCH00020
#&gt; 2                        NA                     NA    MCH00002
#&gt; 3                        NA                     NA    MCH00006
#&gt; 4                        NA                     NA    MCH00009
#&gt; 5                        NA                     NA    MCH00014
#&gt; ...                     ...                    ...         ...
#&gt; 66                       NA                     NA    SM834451
#&gt; 67                       NA                     NA    SM855703
#&gt; 68                       NA                     NA    SM882851
#&gt; 69                       NA                     NA    SM849703
#&gt; 70                       NA                     NA    SM858801
#&gt;              spectrum_name                   date                authors
#&gt;                &lt;character&gt;            &lt;character&gt;            &lt;character&gt;
#&gt; 1   Adenosine 5'-triphos.. 2016.01.19 (Created .. Yoshikuni K, Tajiri ..
#&gt; 2   Gentisic acid; MALDI.. 2016.01.19 (Created .. Wada Y, Osaka Medica..
#&gt; 3   Gentisic acid; MALDI.. 2016.01.19 (Created .. Wada Y, Osaka Medica..
#&gt; 4   5-Methoxysalicylic a.. 2016.01.19 (Created .. Wada Y, Osaka Medica..
#&gt; 5   Sinapic acid; MALDI-.. 2016.01.19 (Created .. Wada Y, Osaka Medica..
#&gt; ...                    ...                    ...                    ...
#&gt; 66  m-Xylene-4-sulfonic ..             2016.12.12 Krauss M, Schymanski..
#&gt; 67  Verapamil; LC-ESI-QF..             2016.12.12 Krauss M, Schymanski..
#&gt; 68  Daidzein; LC-ESI-QFT..             2016.12.12 Krauss M, Schymanski..
#&gt; 69  Oxybutynin; LC-ESI-Q..             2016.12.12 Krauss M, Schymanski..
#&gt; 70  Diphenhydramine; LC-.. 2019.11.20 (Created .. Krauss M, Schymanski..
#&gt;         license              copyright            publication
#&gt;     &lt;character&gt;            &lt;character&gt;            &lt;character&gt;
#&gt; 1      CC BY-SA                     NA                     NA
#&gt; 2      CC BY-SA                     NA                     NA
#&gt; 3      CC BY-SA                     NA                     NA
#&gt; 4      CC BY-SA                     NA                     NA
#&gt; 5      CC BY-SA                     NA                     NA
#&gt; ...         ...                    ...                    ...
#&gt; 66        CC BY Copyright (C) 2016 U.. Schymanski, E. L.; R..
#&gt; 67        CC BY Copyright (C) 2016 U.. Schymanski, E. L.; R..
#&gt; 68        CC BY Copyright (C) 2016 U.. Schymanski, E. L.; R..
#&gt; 69        CC BY Copyright (C) 2016 U.. Schymanski, E. L.; R..
#&gt; 70        CC BY Copyright (C) 2016 U.. Schymanski, E. L.; R..
#&gt;                     splash compound_id      adduct  ionization
#&gt;                &lt;character&gt;   &lt;integer&gt; &lt;character&gt; &lt;character&gt;
#&gt; 1   splash10-0a4i-000090..           1      [M-H]-          NA
#&gt; 2   splash10-004r-191300..           2          NA          NA
#&gt; 3   splash10-0udi-090200..           3          NA          NA
#&gt; 4   splash10-0fri-093000..           4          NA          NA
#&gt; 5   splash10-006t-019080..           5          NA          NA
#&gt; ...                    ...         ...         ...         ...
#&gt; 66  splash10-000i-090000..          66      [M-H]-         ESI
#&gt; 67  splash10-066r-090030..          67      [M+H]+         ESI
#&gt; 68  splash10-0udi-009000..          68      [M-H]-         ESI
#&gt; 69  splash10-0a4i-860900..          69      [M+H]+         ESI
#&gt; 70  splash10-014i-090000..          70      [M+H]+         ESI
#&gt;     ionization_voltage fragmentation_mode collision_energy_text
#&gt;            &lt;character&gt;        &lt;character&gt;           &lt;character&gt;
#&gt; 1                   NA                 NA                    NA
#&gt; 2                   NA                 NA                    NA
#&gt; 3                   NA                 NA                    NA
#&gt; 4                   NA                 NA                    NA
#&gt; 5                   NA                 NA                    NA
#&gt; ...                ...                ...                   ...
#&gt; 66                  NA                HCD         35  (nominal)
#&gt; 67                  NA                HCD         35  (nominal)
#&gt; 68                  NA                HCD         35  (nominal)
#&gt; 69                  NA                HCD         35  (nominal)
#&gt; 70                  NA                HCD         35  (nominal)
#&gt;                 instrument instrument_type precursor_mz_text
#&gt;                &lt;character&gt;     &lt;character&gt;       &lt;character&gt;
#&gt; 1   LTQ Orbitrap XL, The..     LC-ESI-ITFT        506.000000
#&gt; 2   Voyager DE-PRO, Appl..       MALDI-TOF                NA
#&gt; 3   Voyager DE-PRO, Appl..       MALDI-TOF                NA
#&gt; 4   Voyager DE-PRO, Appl..       MALDI-TOF                NA
#&gt; 5   Voyager DE-PRO, Appl..       MALDI-TOF                NA
#&gt; ...                    ...             ...               ...
#&gt; 66  Q Exactive Plus Orbi..      LC-ESI-QFT          185.0278
#&gt; 67  Q Exactive Plus Orbi..      LC-ESI-QFT          455.2904
#&gt; 68  Q Exactive Plus Orbi..      LC-ESI-QFT          253.0506
#&gt; 69  Q Exactive Plus Orbi..      LC-ESI-QFT          358.2377
#&gt; 70  Q Exactive Plus Orbi..      LC-ESI-QFT          256.1696</div><div class='input'>
<span class='co'>## Add a new spectra variable</span>
<span class='va'>be</span><span class='op'>$</span><span class='va'>new_variable</span> <span class='op'>&lt;-</span> <span class='st'>"b"</span>
<span class='va'>be</span><span class='op'>$</span><span class='va'>new_variable</span>
</div><div class='output co'>#&gt;  [1] "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b"
#&gt; [20] "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b"
#&gt; [39] "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b"
#&gt; [58] "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b" "b"</div><div class='input'>
<span class='co'>## Subset the backend</span>
<span class='va'>be_sub</span> <span class='op'>&lt;-</span> <span class='va'>be</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>]</span>

<span class='fu'>spectraNames</span><span class='op'>(</span><span class='va'>be</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] "MCH00020" "MCH00002" "MCH00006" "MCH00009" "MCH00014" "MCH00019"
#&gt;  [7] "MCH00012" "MCH00003" "MCH00016" "MCH00001" "MCH00018" "MCH00007"
#&gt; [13] "MCH00013" "MCH00015" "MCH00008" "MCH00004" "MCH00005" "MCH00011"
#&gt; [19] "MCH00017" "MCH00010" "SM864952" "SM823851" "SM868004" "SM862204"
#&gt; [25] "SM834302" "SM810352" "SM847101" "SM861203" "SM839603" "SM829401"
#&gt; [31] "SM814501" "SM858902" "SM850104" "SM854403" "SM836003" "SM821703"
#&gt; [37] "SM880602" "SM868101" "SM851552" "SM804503" "SM848503" "SM842251"
#&gt; [43] "SM817703" "SM847302" "SM805801" "SM820101" "SM816753" "SM805001"
#&gt; [49] "SM838051" "SM812904" "SM840401" "SM812701" "SM861901" "SM874401"
#&gt; [55] "SM838502" "SM857001" "SM858203" "SM847702" "SM883903" "SM818403"
#&gt; [61] "SM871101" "SM842156" "SM841901" "SM854306" "SM878551" "SM834451"
#&gt; [67] "SM855703" "SM882851" "SM849703" "SM858801"</div><div class='input'><span class='fu'>spectraNames</span><span class='op'>(</span><span class='va'>be_sub</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "MCH00006" "MCH00020"</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Michael Witting, Johannes Rainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


